<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="windows-1251">
    <link rel="stylesheet" href="style.css">
    <link href="Labs/Lab_style.css" rel="stylesheet">
        </head>
        <body>
            <div id="container">
                <div id="navigation">
                    <a href="index.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/home.png"></div>
                            <div class="nav_right one">Главная</div>
                        </div>
                    </a>
                    <a href="info.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/instruct.png"></div>
                            <div class="nav_right one">Инструкции</div>
                        </div>
                    </a>
                    <a href="teory.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/library.png"></div>
                            <div class="nav_right two">Теоретический материал</div>
                        </div>
                    </a>
                    <a href="labs.html">
                        <div class="nav_button" style="color:#ff6a00">
                             <div class="nav_left"><img src="image/labs.png"></div>
                            <div class="nav_right two">Лабораторные работы</div>
                        </div>
                    </a>
                    <a href="adds.html">
                        <div class="nav_button">
                             <div class="nav_left"><img src="image/lupe.png"></div>
                            <div class="nav_right two">Дополнительные материалы</div>
                        </div>
                    </a>
                </div>

				
				<div class="left">
				<!--Навигация внутри страницы (якоря)-->
                    <div class="main header" style="margin: auto;">
                        <h1>Автоматизированное тестирование средствами Selenium</h1>
						<div class="local">
						<a href="#up"><div class="local_nav">Вверх</div></a>
						<a href="#down"><div class="local_nav">Вниз</div></a>
						<div class="local_nav_bord"></div>
						<a href="Lab7a.html"><div class="local_nav">Следующая</div></a>
						<a href="#end"><div class="local_nav">Отчет</div></a>
						<a href="#test"><div class="local_nav">Создание теста</div></a>
						<a href="#around"><div class="local_nav">Окружение</div></a>
						<a href="#install"><div class="local_nav">Установка</div></a>
						<a href="Lab6.html"><div class="local_nav">Предыдущая</div></a>
						</div>
                    </div>					

                <div class="content" style="overflow: scroll;">
					<div class="incontent">
				
				<h1>Установка пакета Selenium 2.0 для MSVisual Studio. Написание тест-кейсов на Selenium 2.0</h1>
				<p><b>Цель:</b> Рассмотреть инструментарий программного пакета Selenium для автоматизированного тестирования приложений.</p>
				<h2 id="install">Установка</h2>
				<p>Запустите Visial Studio и создайте новый проект Windows form.</p>
				<p>Далее откройте меню “Проект” (project), и выберите пункт«Управление пакетами NuGet» (Manage NuGetPackages), или нажмите правой
					кнопкой в «Обозревателе объектов» (SolutionExplorer) и в контекстном меню
					выберите пункт  «Управление пакетами NuGet» (Manage NuGetPackages). Должно открыться окно
					«Менеджера пакетов NuGet».</p>
				<p>Убедитесь,
					что ваш компьютер подключен к сети Интернет. Далее, выберите поиск онлайн,
					задайте ключевое слово поиска “Selenium”, из выбранного списка выберите для
					установки Selenium WebDriver и Selenium WebDriver Support Classes. Нажмите
					кнопку «Установить» (Instal) и дождитесь окончания
					автоматической установки.</p>
					<p style='text-align:center;'><img width=624 height=420 src="Labs/Lab7.files/image001.jpg"></p>
				<p>После установки у данных элементов будут стоять «галочки», подтверждающие установку.</p>
				<p style='text-align:center;'><img width=623 height=417 src="Labs/Lab7.files/image002.jpg"></p>
				<!--<p>Установка из файла, если нет интернета</p>-->
			
					<p style="border:solid; border-color: #52999D;"><b>Задание 1:</b>
					<br>Произведите установку программных пакетов для Selenium</p>
				
				<h2 id="around">Настройка окружения</h2>
				<p>После успешной установки пакетов, закройте  «Управление пакетами NuGet».  Добавьте новые директивы, связанные с Selenium, а также те, которые понадобятся для работы с
					файлами, для этого допишите, сверху следующий код.</p>
				<p style='text-align:center;'><img width=219 height=100 src="Labs/Lab7.files/image003.png"></p>
				<p>Директивы OpenQA.Selenium и OpenQA.Selenium.Firefox – отвечают за
					взаимодействие с библиотеками Selenium
					и браузерами, в данном случае выбран браузер MozillaFirefox.</p>
				<p>Директива System.Drawing.Imaging используется
					для создания снимков окна браузера для создания отчетов по выполнению тестов.</p>
				<p>Директива IO используется для записи данных о ходе процесса в лог-файл.</p>
				<p>Директивы System.Data и System.Data.OleDb нужны для связи с Excel-файлом и получения из него тестовых наборов данных.</p>
				<p>Далее зададим параметры как показано на рисунке.</p>
				<p style='text-align:center;'><img width=233 height=52 src="Labs/Lab7.files/image004.png"></p>
				<p>IWebDriverсоздает новый экземпляр Веб-драйвера – средства управления браузером в Selenium.</p>
				<p>baseURL – переменная задающая URL-адрес страницы, с которой будет взаимодействовать тестирующее приложение.</p>
				<p>Далее создается счетчик i, который будет указывать имя снимка экрана.</p>
				<p>Далее создадим форму нашего приложения.</p>
				<p style='text-align:center;'><img width=623 height=233 src="Labs/Lab7.files/image005.jpg"></p>
				<p>Для этого перетащить из панели инструментов
					три кнопки, для формы, а также два элемента Label, для
					того, чтобы с помощью них указать о начале и завершении тестирования.</p>
				<p style='text-align:center'><img width=471 height=132 src="Labs/Lab7.files/image006.png"></p>
				<p>Сперва создадим события для вспомогательных кнопок «Открыть лог-файл» и «Открыть директорию со снимками».</p>
				<p>Нажмем дважды по кнопке «Открыть лог-файл», после чего автоматически создастся событие для данной кнопки.</p>
				<p style='text-align:center;'><img width=418 height=91 src="Labs/Lab7.files/image007.png"></p>
				<p>В данном случае
					запускается файл, путь к которому указывается в качестве аргумента. После
					запуска приложения, при нажатии на кнопку откроется указанный файл, если он был
					создан.</p>
				<p class="attention"><b>!!! В качестве пути НЕ может быть выбрана корневая директория
							диска или иная другая, требующая подтверждения прав администратора.</b></p>
				
					<p style="border:solid; border-color: #52999D;"><b>Задание 2:</b>
					<br>По аналогии самостоятельно создайте событие на открытие директории, в которой будут хранится снимки.</p>
				
				<p>Далее двойным нажатием создаем событие для кнопки «Открыть директорию со снимками». После чего
					копируем следующий код. Стоит отметить, что директорию необходимо создать
					самостоятельно.</p>
				<p style='text-align:center;'><img width=398 height=96 src="Labs/Lab7.files/image008.png"></p>
				<p>После запуска приложения, при нажатии на кнопку откроется указанная директория, если он был создана.</p>
				<p>Далее создадим функцию для создания снимка окна браузера.</p>
				<p>Создадим новую функцию ScreenShot.</p>
				<p style='text-align:center;'><img width=500 height=177 src="Labs/Lab7.files/image009.png"></p>
				<p>Зададим строковый аргумент х,
					который будет являться именем файла, который будет задаваться программистом.
					Далее переводим изображение в строковую переменную. После чего задается путь и
					формат для нового файла. В конце происходит увеличение счетчика, для того,
					чтобы не создавалось нового снимка с именем, которое уже было использовано, так
					как произойдет замена файла.</p>	
					
				<p>В конце происходит
					увеличение счетчика, для того, чтобы не создавалось нового снимка с именем,
					которое уже было использовано, иначе произойдет замена файла.</p>
					
					<p style="border:solid; border-color: #52999D;"><b>Задание 3:</b>
					<br>По аналогии самостоятельно создайте для создания снимка экрана</p>
				
				<p>Создайте функцию для создания  новой записи в лог-файл с именем Log.</p>
				<p style='text-align:center;'><img width=486 height=119 src="Labs/Lab7.files/image010.png"></p>
				<p>Создайте
					новый экземпляр элемента StreamWriter и укажем ему путь
					к файлу в который будут сохраняться логи. Далее создадим новую строку в
					документ с указанием текущей даты и времени, для получения более точных
					сведений, и аргументом, который будет задаваться программистом. В конце
					экземпляр закрывается, чтобы сохранить изменения в документе.</p>
					
				<p style="border:solid; border-color: #52999D;"><b>Задание 4:</b>
					<br>По аналогии самостоятельно создайте функцию логирования хода тестирования.</p>
					
				<h2 id="test">Создание тест-кейса</h2>
				<p>В функцию Mainпосле инициализации компонентов формы зададим переменную baseURL, которая указывает путь к калькулятору на сайте “google.com”, для получения пути
					необходимо сделать запрос в браузере, после чего скопировать получившийся
					результат в код программы.</p>
				<p style='text-align:center;'><img width=598 height=116 src="Labs/Lab7.files/image011.png"></p>
				<p>Далее создадим событие для
					основной кнопки «Start», после нажатия которой будет
					выполняться автоматическое тестирование веб-страницы. Сперва в теле события
					пропишем следующий код.</p>
				<p style='text-align:center;'><img width=459 height=112 src="Labs/Lab7.files/image012.png"></p>
				<p>Сперва, указывается драйвер
					браузера, который будет использоваться. В данном случае браузер Mozille Firefox.
					После выполнения этой строки произойдет открытие браузера. Создадим первую
					запись в лог-файл о том, что у нас открылся браузер. Вызовем созданную функцию Log и в качестве аргумента укажем текст как на рисунке.</p>
				<p>Далее вызывается метод Navigate() для перехода на необходимую страницу.</p>
				<p>После зададим  методы Timeouts() для задания временной задержки между событиями
					выполняемыми с браузером. И Windows.Maximaze()
					для открытия окна браузера на весь экран компьютера для лучшего наблюдения за
					ходом процесса тестирования.</p>
				<p>Экземпляр элемента IWebElement  нужен для взаимодействия с элементами сайта,
					которые находятся различными способами. В данном случает найде элемент строки
					ввода по Id стиля. Чтобы получить id
					или class name
					необходимо открыть в браузере «Инспектор DOM и стилей»,
					для этого нажмите правой кнопкой мыши на интересующем элементе, в нашем случае
					строка ввода, и из ниспадающего списка выберите пункт «Исследовать элемент»</p>
				<p style='text-align:center;'><img width=623 height=407 src="Labs/Lab7.files/image013.jpg"></p>
				<p>Скопируем необходимый стиль вметод By.Id().</p>
				<p>Следующим шагом будет
					создание и подключение Excel-документа с тестовыми
					наборами данных. Создадим подключение к документу, в строковой переменной con укажем параметры подключения к файлу. Далее используя
					метод OleDbConnection подключимся к документу. Создадим
					новый экземпляр элемента OleDbCommand, в аргументах
					которого укажем SQL-запрос к таблице. После чего
					используем объект OleDbDataReader для чтения записей из
					таблицы. После чего создадим цикл для чтения данных.</p>
				<p style='text-align:center;'><img width=599 height=146 src="Labs/Lab7.files/image014.jpg"></p>
				<p>На данном этапе создадим
					документ test.xlsx в директории
					из которой он будет вызываться согласно строке подключения к документу, который
					будет содержать тестовые наборы данных. Зададим четыре столбца: первый операнд,
					действие, второй операнд и результат действия.</p>
				<p style='text-align:center;'><img width=274 height=125 src="Labs/Lab7.files/image015.png"></p>
				<p>Далее выведем первый
					операнд из документа test.xlsx,
					для этого найдем элемент строки ввода по id стиля, и
					используем метод SendKeys(), аргументом которого будет
					элемент первого столбца dr[0]. После чего добавим
					соответствующую запись в лог-файл.</p>
				<p style='text-align:center;'><img width=466 height=46 src="Labs/Lab7.files/image016.png"></p>
				<p>Далее необходимо указать
					знак оператора, для этого создадим условие switсh, которое будет брать из Excel-документа
					брать оператор, который с помощью метода FindElement()
					будет находить элемент на сайте соответствующий оператору. Также будет
					добавляться новая запись в лог-файл.</p>
				<p style='text-align:center'><img width=421 height=113 src="Labs/Lab7.files/image017.png"></p>
				<p>После оператора switch к элементу searchInputприменяем метод Click(), имитирующий
					нажатие левой клавиши мыши на данный элемент.</p>
				<p style='text-align:center;'><img width=151 height=30 src="Labs/Lab7.files/image018.png"></p>
				
				<p style="border:solid; border-color: #52999D;"><b>Задание 5:</b>
					<br>Самостоятельно добавьте ввод второго операнда после ввода знака оператора.</p>

				<p>Перед тем как получить
					результат вычисления стоит сохранить в лог-файле запись информирующую о том,
					какие операнды и какое действие между ними будет происходить.</p>
				<p style='text-align:center;'><img width=522 height=33 src="Labs/Lab7.files/image019.png"></p>
				<p>Самостоятельно использую
					методы FindElement() и Click() найдите
					кнопку равно на форме и совершите имитацию нажатия на нее. Сохраните полученный
					результат в лог-файле.</p>
				<p>Далее сравниваем полученный
					результат с эталонным результатом и выводим в лог-файл результат сравнения,
					если результат не совпадает, значит есть необходимость в создании снимка
					страницы для более детального отчета.</p>
				<p style='text-align:center;'><img width=623 height=102 src="Labs/Lab7.files/image020.jpg"></p>
				
				<p style="border:solid; border-color: #52999D;"><b>Задание 5:</b>
					<br>Самостоятельно используя
					методы FindElement() и Click() найдите
					кнопку очищения строки ввода и совершите имитацию нажатия на нее. Сохраните
					полученный результат в лог-файле.</p>
				<p>В конце тела функции напишем
					следующий код.</p>
				<p style='text-align:center;'><img width=234 height=82 src="Labs/Lab7.files/image021.png"></p>
				<p>Метод Cloce()
					закроет браузер после выполнения тестирования. После чего создадим
					соответствующую запись в лог-файле. А также укажем о завершении работы тестов
					на основной форме приложения, для того, чтобы было видно, что программа
					завершила работу. Для этого объекту label зададим
					параметр Text с текстом о завершении теста. После чего
					создадим еще одну соответствующую запись в лог-файле.</p>
				<p>Далее открыть лог-файл,
					проверить правильность выполнения тестов. Составить отчет на основе полученных
					данных, о результатах сообщить преподавателю. К отчету приложить архив с
					полученными снимками браузера, а также лог-файл.</p>

				<hr size=3 width=90% color=black>					
				<h2 id="end">Контрольное задание</h2>
				<p>Самостоятельно разработайте тестовые варианты на выполнение
					операции отрицание и заполните отчет.
				</p>
				<h2>Требования к отчету об автоматизированном тестировании</h2>
				<ol>
					<li>Указание название и функций тестируемого приложения.</li>
					<li>Приложенный файл в формате xls тестовых вариантов используемых при тестировании.</li>
					<li id="down">Приложенный лог-файл, полученный при тестировании.</li>
				</ol>
			</div>
        </div>
		</div>
     </div>
    </body>
</html>