<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="windows-1251">
    <link rel="stylesheet" href="style.css">
    <link href="Labs/Lab_style.css" rel="stylesheet">
        </head>
        <body>
            <div id="container">
                <div id="navigation">
                    <a href="index.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/home.png"></div>
                            <div class="nav_right one">Главная</div>
                        </div>
                    </a>
                    <a href="info.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/instruct.png"></div>
                            <div class="nav_right one">Инструкции</div>
                        </div>
                    </a>
                    <a href="teory.html">
                        <div class="nav_button">
                            <div class="nav_left"><img src="image/library.png"></div>
                            <div class="nav_right two">Теоретический материал</div>
                        </div>
                    </a>
                    <a href="labs.html">
                        <div class="nav_button" style="color:#ff6a00">
                             <div class="nav_left"><img src="image/labs.png"></div>
                            <div class="nav_right two">Лабораторные работы</div>
                        </div>
                    </a>
                    <a href="adds.html">
                        <div class="nav_button">
                             <div class="nav_left"><img src="image/lupe.png"></div>
                            <div class="nav_right two">Дополнительные материалы</div>
                        </div>
                    </a>
                </div>
				
				
				
				<div class="left">
				<!--Навигация внутри страницы (якоря)-->
                    <div class="main header" style="margin: auto;">
                        <h1>Автоматизированное тестирование средствами AutoIT</h1>
						<div class="local">
						<a href="#up"><div class="local_nav">Вверх</div></a>
						<a href="#down"><div class="local_nav">Вниз</div></a>
						<div class="local_nav_bord"></div>
						<a href="Lab7.html"><div class="local_nav">Следующая</div></a>
						<a href="#end"><div class="local_nav">Отчет</div></a>
						<a href="#test"><div class="local_nav">Создание теста</div></a>
						<a href="#data"><div class="local_nav">Данные</div></a>
						<a href="#log"><div class="local_nav">Логирование</div></a>
						<a href="#install"><div class="local_nav">Установка</div></a>
						<a href="Lab5.html"><div class="local_nav">Предыдущая</div></a>
						</div>
                    </div>					

                <div class="content" style="overflow: scroll;">
					<div class="incontent">
					
                    <h1 id="up">Автоматизированное тестирование средствами AutoIT</h1>
                    <p><b>Цель:</b> Рассмотреть инструментарий приложения AutoIT для автоматизированного тестирования приложений.</p>
                    <p><b>Автоматизированное тестирование программного обеспечения</b> —
                        часть процесса тестирования на этапе контроля качества в процессе разработки
                        программного обеспечения. Оно использует программные средства для выполнения
                        тестов и проверки результатов выполнения, что помогает сократить время
                        тестирования и упростить его процесс.</p>
                    <p>Наиболее распространенной формой автоматизации является
                        тестирование приложений через графический пользовательский интерфейс.
                        Популярность такого вида тестирования объясняется двумя факторами: во-первых,
                        приложение тестируется тем же способом, которым его будет использовать человек,
                        во-вторых, можно тестировать приложение, не имея при этом доступа к исходному
                        коду.</p>
						
                    <h2 id="install">Установка</h2>
                    <p>Для установки программы запустите файл autoit-v3-setup.exe, который находится в папке … или скачайте с официального
                        сайта AutoIt. После запуска файла, откроется окно с
                        кратким описанием версии программы.</p>
                    <p style="text-align:center"><img width=378 height=300 src="Labs/Lab6.files/image001.jpg"></p>
                    <p>На следуещем шаге идет ознакомление с лицензионным соглашением.</p>
                    <p style="text-align:center"><img width=378 height=299 src="Labs/Lab6.files/image002.jpg"></p>
                    <p>Далее пользователь выбирает
                        одну из двух функций по умолчанию для открытия файлов: запуск скрипта или
                        редактирование скрипта. Выберем режим редактирования, при запуске неизвестного
                        скрипта имеется вероятность того, что скрипт будет работать некорректно.</p>
                    <p style="text-align:center"><img width=378 height=294 src="Labs/Lab6.files/image003.jpg"></p>
                    <p>На следующем этапе
                        выбирается вид установки. В данном случае выставляем полную установку всех
                        компонентов приложения.</p>
                    <p style="text-align:center"><img width=378 height=299 src="Labs/Lab6.files/image004.jpg"></p>
                    <p>После выбора типа установки выбирает каталог, куда будет установлена программа.</p>
                    <p style="text-align:center"><img width=378 height=297 src="Labs/Lab6.files/image005.jpg"></p>
                    <p>После выбора всех опций начинается установка приложения.</p>
                    <p style="text-align:center"><img width=378 height=297 src="Labs/Lab6.files/image006.jpg"></p>
                    <p>После завершения установки,
                        будет сообщено об успешности процесса установки, а также предложат посмотреть описание
                        версии установленного приложения.</p>
                    <p style="text-align:center"><img width=378 height=297 src="Labs/Lab6.files/image007.jpg"></p>
                    <p>На этом установка приложения AutoIT завершена. Далее перейдем к запуску самого приложения и созданию тестового скрипта.</p>
					
                    <h2>Запуск</h2>
                    <p>После установки программы, запускаем приложение SciTE ScriptEditor с помощью ярлыка на рабочем
                        столе или в меню пуск. Данная утилита предназначена для создания и изменения
                        скриптов в AutoIT.</p>
                    <p style="text-align:center"><img width=407 height=293 src="Labs/Lab6.files/image008.png"></p>
                    <p>Если автоматически не был создан новый документ, то создаем
                        его с помощью кнопки «Создать новый» на панели инструментов или выбрать
                        соответствующий пункт в меню «File».</p>
                    
					<p style="border:solid; border-color: #52999D;"><b>Задание 1:</b>
					<br>Произведите установку и запустите средство автоматизированного тестировани AutoIT</p>
					
					<h2 id="log">Создание функции логирования</h2>
					<p>Функция логирования одна из самых
                        важных в процессе тестирования. Во-первых, она дает необходимый специалисту по
                        тестированию отчет. Во-вторых, на ранней стадии создания автоматизированного
                        теста логирование можно использовать для отладки самого теста.</p>
                    <p>Для того чтобы создать
                        осуществить логирование, создадим файл log.txt, в который будут сохраняться записи о процессе
                        тестирования. Далее, перейдем к редактированию кода программы. И создадим следующую
                        функцию.</p>
                    <p style="text-align:center"><img width=604 height=99 src="Labs/Lab6.files/image009.png"></p>
                    <p>Аргумент $text – это строка, которую будет выводить программа.</p>
                    <p>Далее, в переменную $hFile указывается имя файла, и режим, в котором будет открыт файл.</p>
                    <p>Может быть комбинацией следующих значений:</p>
                    <p><b>0</b> = (по умолчанию) Открыть только для чтения</p>
                    <p><b>1</b> = Открыть только для записи в конец файла</p>
                    <p><b>2</b> = Открыть только для записи в конец файла, удалив предыдущее содержание</p>
                    <p><b>8</b> = Создать структуру папок, если путь к файлу не существует (см. примечания).</p>
                    <p>Следующей строкой идет метод
                        записи в файл, сперва указывается переменная с именем файла и режимом доступа к
                        нему, а далее указывается время до миллисекунд и текст, который укажет
                        пользователь в качестве аргумента.</p>
                    <p>В последней строке закрывается соединение с файлом.</p>
				
					<p style="border:solid; border-color: #52999D;"><b>Задание 2:</b>
					<br>По аналогии создайте функции логирования хода тестирования.</p>
					
                    <h2 id="data">Получение данных из документа</h2>
                    <p>Создадим документ в MS Excel с названием test.xls. Заполним данными, которые будут обрабатываться при тестировании.</p>
                    <p style="text-align:center"><img width=221 height=145 src="Labs/Lab6.files/image010.png"></p>
                    <p>В первом и втором столбцах указываются операнды, а в третьем столбце указывается ожидаемый результат.</p>
                    <p>Далее создадим отдельный
                        скрипт Data.au3, который будет
                        отвечать за считывание данных из данного документа. В качестве основы скрипта
                        возьмем готовый пример считывания столбца из официальной документации и внесем
                        небольшие изменения.</p>
                    <p>В начале добавим стандартный
                        скрипт для работы с документами в формате xls. Для
                        этого напишем следующую строку в начале скрипта.</p>
                    <p style="text-align:center"><img width=147 height=27 src="Labs/Lab6.files/image011.png"></p>
                    <p >Создадим функцию, которая будет
                        считывать данные в массивы, все последующие изменения будут добавляться внутрь
                        данной функции.</p>
                    <p style="text-align:center"><img width=139 height=62 src="Labs/Lab6.files/image012.png"></p>
                    <p >Далее создадим новое подключение
                        к документу внутри функции Dataread. В переменную $oAppl запишем значение метода открытие файла MS Excel.
                        После чего создадим обработчик условия, на случай возникновения ошибки.@error
                            - состояние флага макроса, которое вызывается
                            автоматически.</p>
                    <p >Следующим шагом создадим
                        переменную $oWorkbook, которая открывает документ MS Excel. Для
                        данной функции также напишем обработчик условия, который выведет сообщение об
                        ошибке и закроет среду MS Excel.</p>
                    <p style="text-align:center"><img width=484 height=139 src="Labs/Lab6.files/image013.png"></p>
                    <p>После того как необходимый
                        документ с данными будет открыт, приступаем к чтению данных. Для этого в
                        глобальную переменную $nRa запишем данные полученные
                        методом _Excel_RangeRead из
                        столбца А.</p>
                    <p style="text-align:center"><img width=624 height=23 src="Labs/Lab6.files/image014.jpg"></p>
                    <p>Самостоятельно добавьте
                        переменные $nRb и $nRc, в
                        которые будут считаны данные со столбцов B и C.</p>
                    <p>Далее создадим проверку
                        условия ошибки чтения.</p>
                    <p style="text-align:center"><img width=372 height=26 src="Labs/Lab6.files/image015.png"></p>
                    <p>В завершении функции
                        получим количество записей в массиве $nRA, данное
                        значение является количеством тестов, которые будут проведены при тестировании.</p>
                    <p style="text-align:center"><img width=178 height=27 src="Labs/Lab6.files/image016.png"></p>
                    <p>На этом создание и настройка окружения закончена, переходим к созданию самого теста.</p>

					<p style="border:solid; border-color: #52999D;"><b>Задание 3:</b>
					<br>По аналогии создайте получение данных из документа Excel</p>
					
                    <h2 id="test">Создание теста</h2>
                    <p>После того, как созданы подготовительные этапы, переходим к
                        созданию автоматизированного теста. Переходим к скрипту Calc.au3.</p>
                    <p>В начале программы добавим ссылку на скрипт Data.au3, который отвечает за
                        считывание тестовых данных из файла test.xls. Для этого допишем следующую строку:</p>
                    <p style="text-align:center"><img width=142 height=31 src="Labs/Lab6.files/image017.png"></p>
                    <p>После чего вызовем функцию Dataread(), которую создали ранее.
                        А также добавим вызов функцию LogWrite, для записи
                        информации,  о том, что данные были считаны.</p>
                    <p style="text-align:center"><img width=216 height=46 src="Labs/Lab6.files/image018.png"></p>
                    <p>Следующим шагом объявим основные переменные тестового приложения.</p>
                    <p style="text-align:center"><img width=126 height=74 src="Labs/Lab6.files/image019.png"></p>
                    <p>Array – предназначена для  хранения номеров непройденных
                        тестов, начальный размер массива равен одному, но в последствии он будет
                        увеличиваться автоматически по мере увеличения непройденных тестов.</p>
                    <p>Далее идут счетчики для различных циклов $var и $i</p>
                    <p>Переменная $nX в дальнейшем будет нужна для сравнения результатов тестирования.</p>
                    <p>Следует обратить внимание, что в AutoIT
                        есть только не типизированный тип данных Variant,
                        который принимает тот тип данных, который возвращается из функции.</p>
                    <p>После описания переменных можно приступить к написанию
                        самого теста. Начать следует с запуска приложения. В данном случае тестируется
                        калькулятор. Для запуска приложения используется метод Run(),
                        в качестве аргументов к которому используются путь к файлу приложения. Так как
                        калькулятор является системным приложением, то можно не указывать путь к файлу
                        целиком, а указать только название файла.</p>
                    <p style="text-align:center"><img width=245 height=48 src="Labs/Lab6.files/image020.png"></p>
                    <p>После запуска приложение,
                        возникает потребность в обращении к элементам управления приложения. Для
                        обращения к ним используется имена классов объктов, например кнопки или строка
                        ввода. Но названия классов для разных видов операционных систем могут отличаться,
                        для того, чтобы тест был кроссплатформенным необходимо дописать условие выбора.
                        Напишем оператор Swicth с версиями операционной системы. Переменная @OSVersion
                        получает автоматически версию операционной системы. Далее в блоке Caseопишем условия выбора.</p>
                    <p style="text-align:center"><img width=252 height=110 src="Labs/Lab6.files/image021.png"></p>
                    <p>Далее приступаем к работе непосредственно с самим
                        калькулятором. Создадим начало цикла, в котором $n – количество записей
                        полученных из файла test.xls. После выводим в лог-файл номер теста, который
                        совпадает и итерациями цикла. И обнуляем переменную $nX, которая в последствии
                        будет использоваться для сравнения результатов.</p>
                    <p style="text-align:center"><img width=235 height=60 src="Labs/Lab6.files/image022.png"></p>
                    <p>Следующим этапом внутри цикла указываем проверку окна на
                        активность. Используем стандартный метод WinWaitActive, который проверяет активность
                        окна калькулятора, обращаясь по классу, в течении 5 секунд. Если окно не
                        активно, то выдается системное сообщений, о том, что окно не было запущено или
                        было закрыто. После чего станавливается работа тестового приложения.</p>
                    <p style="text-align:center"><img width=524 height=111 src="Labs/Lab6.files/image023.png"></p>
                    <p>Внутри условия активности будет располагаться все остальное
                        тело программы. Далее с помощью метода Send() сообщаем
                        калькулятору значение элемента $i из массива первых
                        операндов.</p>
                    <p style="text-align:center"><img width=250 height=49 src="Labs/Lab6.files/image024.png"></p>
                    <p>Следующим шагом необходимо указать оператор действия. По
                        причине того, что тестируется только функция сложения, то укажем только одно
                        действие. Для нахождения класса элемента управления используется утилита AutoIT WindowsInfo.</p>
                    
					<h2>Получение значения кнопок через Windowsinfo</h2>
                    <p>Одной из функций
                        автоматизированных текстов является обращение к элементам управления на форме
                        приложения, или же симуляция их нажатия. Для обращения имеются стандартные
                        методы Send() и ControlClick(). Но для того, чтобы совершить обращение к
                        элементу необходимо узнать его идентификатор. После установки приложения AutoIT
                        была установлена утилита AutoIT Windows Info, предназначенная для сбора
                        информации об элементах управления в окнах.</p>
                    <p>По причине того, что требуется некоторое время для ввода
                        данных поставим задержку до нажатия клавиши, используя метод Sleep(),
                        установив время на 50 миллисекунд</p>
                    <p style="text-align:center"><img width=553 height=41 src="Labs/Lab6.files/image025.png"></p>
                    <p>Далее самостоятельно допишите добавление второго операнда и
                        нажатие кнопки «равно».</p>
                    <p>Получение данных</p>
                    <p style="text-align:center"><img width=454 height=33 src="Labs/Lab6.files/image026.png"></p>
                    <p>Удаление пробела в конце</p>
                    <p style="text-align:center"><img width=192 height=27 src="Labs/Lab6.files/image027.png"></p>
                    <p>Удаление последней запятой</p>
                    <p style="text-align:center"><img width=281 height=60 src="Labs/Lab6.files/image028.png"></p>
                    <p>Самостоятельно выведите в лог значения полученные при тестирование и ожидаемые.</p>
                    <p>Проверяем прохождение теста</p>
                    <p style="text-align:center"><img width=264 height=140 src="Labs/Lab6.files/image029.png"></p>
                    <p>Самостоятельно напишите очистку формы, с помощью кнопки очистки на форме калькулятора.</p>
                    <p>Далее необходимо добавить в конце цикла прибавление к
                        счетчику цикла $i. На этом работа с основным циклом
                        завершена, переходим к выводу информации.</p>
                    <p>Вся информация по тестам хранится в переменных и размере
                        массива. Получаем размер массива, который хранит в себе номера непройденных
                        тестов</p>
                    <p style="text-align:center"><img width=148 height=25 src="Labs/Lab6.files/image030.png"></p>
                    <p>Вывод количества тестов и вывод количества непройденных
                        тестов. Переменная $n хранит в себе количество тестовых
                        записей в файле text.xls.</p>
                    <p style="text-align:center"><img width=276 height=42 src="Labs/Lab6.files/image031.png"></p>
                    <p>Из значения $b вычитается единица,
                        так как размер массива превышает количество непройденных тестов на один.</p>
                    <p>Следующим шагом создадим цикл, который выведет номера
                        тестов, которые не были пройдены.</p>
                    <p style="text-align:center"><img width=331 height=88 src="Labs/Lab6.files/image032.png"></p>
                    <p>В конце теста добавим вывод сообщения об окончании тестирования.</p>
                    <p style="text-align:center"><img width=354 height=28 src="Labs/Lab6.files/image033.png"></p>
                    <p>Первый аргумент является флагом сообщения. Код 4096 задает
                        системный тип окна, которое появляется поверх остальных окон. Далее идут
                        заголовок сообщения и текст.</p>
                    <p>На этом этапе написание теста закончено, теперь можно
                        перейти к запуску теста. Для этого в меню «Tools»
                        выберите пункт «Go» или нажмите клавишу F5. В ходе выполнения теста произойдет открытие файла test.xls и калькулятора. После
                        завершения работы появится диалоговое окно о завершении тестирования, которое
                        было создано ранее. Далее можно закрыть калькулятор и MSExcel и открыть файл логирования,
                        который был сформирован в ходе выполнения тестирования.</p>

					                    
					<p style="border:solid; border-color: #52999D;"><b>Задание 4:</b>
					<br>На основе примера создайте автоматизированный тест.</p>
					
					<hr size=3 width=90% color=black>
                    <h2 id="end">Контрольное задание</h2>
                    <p>Самостоятельно проведите тестирование программы, соответствующее вашему варианту, на основе созданных тестовых вариантов и заполните отчет.</p>
					Вариант задания выбирается по последним двум цифрам в студенческом билете.
                    <h3>Требования к отчету об автоматизированном тестировании</h3>
					<ol>
						<li>Указание название и функций тестируемого приложения.</li>
						<li>Снимок интерфейса приложения.</li>
						<li>Приложенный файл в формате xls тестовых вариантов используемых при тестировании.</li>
						<li id="down">Приложенный лог-файл, полученный при тестировании.</li>
					</ol>
                </div>
				</div>
            </div>
		</div>
    </body>
</html>
